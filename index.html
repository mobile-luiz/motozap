<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotoZap - Sua corrida r√°pida no interior</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" id="manifest">
    
    <!-- Scripts -->
    <script src="app.js" defer></script>
    <script src="pwa.js" defer></script>
    <script src="notifications.js" defer></script>


    
</head>
<body>
    <!-- Mobile Notifications Container -->
    <div id="mobileNotifications" class="mobile-notifications"></div>

    <!-- Install App Banner -->
    <div id="installBanner" class="install-banner hidden">
        <div>
            <strong>üì± Instalar App MotoZap</strong>
            <p style="margin-top: 5px; font-size: 0.9rem;">Tenha notifica√ß√µes push e acesso r√°pido!</p>
        </div>
        <button id="installBtn">
            <i class="fas fa-download"></i> Instalar
        </button>
    </div>

    <!-- Main Screen -->
    <div id="mainScreen" class="container">
        <header>
            <div class="logo">
                <i class="fas fa-motorcycle"></i>
                <h1>MOTOZAP</h1>
            </div>
            <p class="tagline">Sua corrida r√°pida no interior</p>
        </header>

        <main>
            <div class="user-options">
                <!-- Passenger Option -->
                <div class="option-card" id="passengerOption">
                    <div class="option-header">
                        <i class="fas fa-user"></i>
                        <h2>Sou Passageiro</h2>
                    </div>
                    <p class="option-description">
                        Quero pedir uma moto agora para me levar ao meu destino com rapidez e seguran√ßa.
                    </p>
                    <button class="btn-action" id="passengerBtn">
                        <i class="fas fa-motorcycle"></i> Pedir uma Moto
                    </button>
                </div>

                <!-- Driver Option -->
                <div class="option-card" id="driverOption">
                    <div class="option-header">
                        <i class="fas fa-helmet-safety"></i>
                        <h2>Sou Piloto</h2>
                    </div>
                    <p class="option-description">
                        Quero realizar corridas e aumentar minha renda transportando passageiros pela cidade.
                    </p>
                    <button class="btn-action" id="driverBtn">
                        <i class="fas fa-road"></i> Realizar Corridas
                    </button>
                </div>
            </div>

            <div class="info-box">
                <h3><i class="fas fa-info-circle"></i> Importante</h3>
                <p>O valor da corrida √© combinado <strong>diretamente com o piloto</strong>, garantindo flexibilidade e negocia√ß√£o justa para ambos.</p>
                <p style="margin-top: 10px;"><strong>MotoZap</strong> - O motot√°xi do interior</p>
            </div>
        </main>

        <footer>
            <div class="footer-logo">MotoZap</div>
            <p>Conectando passageiros e pilotos no interior</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">¬© 2023 MotoZap - Todos os direitos reservados</p>
        </footer>
    </div>

    <!-- Login/Register Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2 id="modalTitle">Entrar no MotoZap</h2>
            
            <div id="statusMessage" class="status-message"></div>
            
            <form id="authForm">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" class="form-control" required minlength="6">
                </div>
                
                <div class="form-group" id="nameField" style="display: none;">
                    <label for="name">Nome Completo</label>
                    <input type="text" id="name" class="form-control" required>
                </div>
                
                <div class="form-group" id="phoneField" style="display: none;">
                    <label for="phone">Telefone</label>
                    <input type="tel" id="phone" class="form-control" placeholder="(11) 99999-9999" required>
                </div>
                
                <div class="form-group" id="vehicleField" style="display: none;">
                    <label for="vehicle">Placa da Moto</label>
                    <input type="text" id="vehicle" class="form-control" placeholder="ABC-1234">
                </div>
                
                <button type="submit" class="btn-action" id="authSubmit">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
            </form>
            
            <p style="margin-top: 20px; text-align: center;">
                <a href="#" id="toggleAuthMode">N√£o tem uma conta? Cadastre-se</a>
            </p>
        </div>
    </div>

    <!-- Dashboard (for logged in users) -->
    <div id="dashboardScreen" class="container dashboard">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </button>
            <button class="tab-btn" data-tab="profile">
                <i class="fas fa-user-edit"></i> Perfil
            </button>
            <button class="tab-btn" data-tab="history">
                <i class="fas fa-history"></i> Hist√≥rico
            </button>
        </div>

        <div class="dashboard-header">
            <div class="user-info" id="userProfileBtn">
                <div class="user-avatar" id="userAvatar">U</div>
                <div>
                    <h3 id="userName">Usu√°rio</h3>
                    <p id="userRole">Papel</p>
                </div>
            </div>
            <div style="display: flex; align-items: center;">
                <!-- Notification Bell (only for drivers) -->
                <div id="notificationBell" class="notification-bell" style="display: none;">
                    <i class="fas fa-bell"></i>
                    <span id="notificationBadge" class="badge" style="display: none;">0</span>
                </div>
                <button class="profile-btn" id="profileBtn">
                    <i class="fas fa-user-edit"></i> Perfil
                </button>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
        
        <!-- Dashboard Tab Content -->
        <div id="dashboardTab" class="tab-content active">
            <div id="passengerDashboard" style="display: none;">
                <h2 style="color: #FF6600; margin-bottom: 20px;">Buscar Corrida</h2>
                <div class="option-card">
                    <div class="option-header">
                        <i class="fas fa-map-marker-alt"></i>
                        <h2>Solicitar Corrida</h2>
                    </div>
                    <p class="option-description">
                        Informe seu destino e encontraremos um piloto dispon√≠vel para te atender.
                    </p>
                    <div class="form-group">
                        <label for="pickupLocation">Local de Partida</label>
                        <input type="text" id="pickupLocation" class="form-control" placeholder="Ex: Av. Paulista, 1000" value="Centro da Cidade">
                    </div>
                    <div class="form-group">
                        <label for="destination">Destino</label>
                        <input type="text" id="destination" class="form-control" placeholder="Ex: Jardim Bot√¢nico" value="Bairro Residencial">
                    </div>
                    <div class="form-group">
                        <label for="ridePrice">Valor Sugerido (R$)</label>
                        <input type="number" id="ridePrice" class="form-control" placeholder="20.00" value="15" min="5" step="0.01">
                    </div>
                    <button class="btn-action" id="requestRideBtn">
                        <i class="fas fa-search"></i> Buscar Piloto
                    </button>
                </div>
                
                <div id="rideStatus" class="ride-status-box" style="display: none;">
                    <h3><i class="fas fa-spinner fa-spin" id="rideStatusIcon"></i> <span id="rideStatusTitle">Status da Corrida</span></h3>
                    <div id="rideDetails">
                        <!-- Ride details will be inserted here -->
                    </div>
                    
                    <!-- WhatsApp Communication Section (shown when ride is accepted) -->
                    <div id="whatsappSection" class="communication-section" style="display: none;">
                        <h4><i class="fab fa-whatsapp"></i> Falar com o Piloto</h4>
                        <div class="phone-info">
                            <p><strong>Piloto:</strong> <span id="driverContactName">N√£o informado</span></p>
                            <p class="phone-number"><i class="fas fa-phone"></i> <span id="driverPhoneNumber">N√£o informado</span></p>
                            <p><small>Clique no bot√£o abaixo para conversar no WhatsApp</small></p>
                        </div>
                        <div class="communication-actions">
                            <a id="whatsappPassengerBtn" class="whatsapp-btn" target="_blank">
                                <i class="fab fa-whatsapp"></i> Falar no WhatsApp
                            </a>
                            <a id="callPassengerBtn" class="call-btn">
                                <i class="fas fa-phone"></i> Ligar
                            </a>
                        </div>
                    </div>
                    
                    <div id="rideActions" style="margin-top: 20px;">
                        <button class="btn-action" id="cancelRideBtn" style="background-color: #dc3545;">
                            <i class="fas fa-times"></i> Cancelar Corrida
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="driverDashboard" style="display: none;">
                <h2 style="color: #FF6600; margin-bottom: 20px;">Painel do Piloto</h2>
                
                <div class="option-card">
                    <div class="option-header">
                        <i class="fas fa-road"></i>
                        <h2>Disponibilidade</h2>
                    </div>
                    <p class="option-description">
                        Alterne sua disponibilidade para receber solicita√ß√µes de corrida.
                    </p>
                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn-action" id="toggleAvailabilityBtn" style="width: auto; padding: 15px 30px;">
                            <i class="fas fa-power-off"></i> <span id="availabilityText">Estou Dispon√≠vel</span>
                        </button>
                    </div>
                    <p id="availabilityStatus" style="text-align: center; font-weight: bold; color: #dc3545;">
                        Status: Indispon√≠vel
                    </p>
                </div>
                
                <div id="activeRideRequests" class="info-box" style="margin-top: 20px;">
                    <h3><i class="fas fa-bell"></i> Solicita√ß√µes de Corrida</h3>
                    <div id="rideRequestsList">
                        <!-- Ride requests will be inserted here -->
                    </div>
                    <p id="noRequestsMessage">Nenhuma solicita√ß√£o de corrida no momento. Fique dispon√≠vel para receber pedidos.</p>
                </div>
                
                <div id="activeRide" class="ride-status-box" style="display: none;">
                    <h3><i class="fas fa-motorcycle"></i> Corrida Ativa</h3>
                    <div id="activeRideDetails">
                        <!-- Active ride details will be inserted here -->
                    </div>
                    
                    <!-- WhatsApp Communication Section (shown when ride is accepted) -->
                    <div id="whatsappDriverSection" class="communication-section" style="display: none;">
                        <h4><i class="fab fa-whatsapp"></i> Falar com o Passageiro</h4>
                        <div class="phone-info">
                            <p><strong>Passageiro:</strong> <span id="passengerContactName">N√£o informado</span></p>
                            <p class="phone-number"><i class="fas fa-phone"></i> <span id="passengerPhoneNumber">N√£o informado</span></p>
                            <p><small>Clique no bot√£o abaixo para conversar no WhatsApp</small></p>
                        </div>
                        <div class="communication-actions">
                            <a id="whatsappDriverBtn" class="whatsapp-btn" target="_blank">
                                <i class="fab fa-whatsapp"></i> Falar no WhatsApp
                            </a>
                            <a id="callDriverBtn" class="call-btn">
                                <i class="fas fa-phone"></i> Ligar
                            </a>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn-action" id="startRideBtn" style="background-color: #0a5c36;">
                            <i class="fas fa-play"></i> Iniciar Corrida
                        </button>
                        <button class="btn-action" id="completeRideBtn" style="background-color: #0a5c36; display: none;">
                            <i class="fas fa-flag-checkered"></i> Finalizar Corrida
                        </button>
                        <button class="btn-action" id="cancelActiveRideBtn" style="background-color: #dc3545; margin-top: 10px;">
                            <i class="fas fa-times"></i> Cancelar Corrida
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profile Tab Content -->
        <div id="profileTab" class="tab-content">
            <div class="profile-section">
                <div class="profile-header">
                    <h2><i class="fas fa-user-edit"></i> Meu Perfil</h2>
                    <button class="close-profile" id="closeProfileBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="profileStatusMessage" class="status-message"></div>
                
                <form id="profileForm" class="profile-form">
                    <div class="form-group">
                        <label for="profileName">Nome Completo *</label>
                        <input type="text" id="profileName" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="profileEmail">E-mail</label>
                        <input type="email" id="profileEmail" class="form-control" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="profilePhone">Telefone *</label>
                        <input type="tel" id="profilePhone" class="form-control" placeholder="(11) 99999-9999" required>
                    </div>
                    
                    <!-- Campo espec√≠fico para piloto -->
                    <div class="form-group" id="profileVehicleField" style="display: none;">
                        <label for="profileVehicle">Placa da Moto</label>
                        <input type="text" id="profileVehicle" class="form-control" placeholder="ABC-1234">
                    </div>
                    
                    <!-- Se√ß√£o para altera√ß√£o de senha -->
                    <div class="password-section">
                        <h4><i class="fas fa-key"></i> Alterar Senha (opcional)</h4>
                        <div class="form-group">
                            <label for="currentPassword">Senha Atual</label>
                            <input type="password" id="currentPassword" class="form-control" placeholder="Digite apenas se quiser alterar">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">Nova Senha</label>
                            <input type="password" id="newPassword" class="form-control" placeholder="M√≠nimo 6 caracteres" minlength="6">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirmar Nova Senha</label>
                            <input type="password" id="confirmPassword" class="form-control" placeholder="Repita a nova senha" minlength="6">
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button type="submit" class="btn-action" id="profileSubmit">
                            <i class="fas fa-save"></i> Salvar Altera√ß√µes
                        </button>
                        <button type="button" class="cancel-btn" id="cancelProfileBtn">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- History Tab Content -->
        <div id="historyTab" class="tab-content">
            <div id="passengerHistory" class="info-box" style="display: none;">
                <h3><i class="fas fa-history"></i> Hist√≥rico de Corridas</h3>
                <p id="noHistoryMessage">Voc√™ ainda n√£o realizou nenhuma corrida.</p>
                <div id="historyList" style="display: none;"></div>
            </div>
            
            <div id="driverHistory" class="info-box" style="display: none;">
                <h3><i class="fas fa-history"></i> Hist√≥rico de Corridas</h3>
                <p id="driverNoHistoryMessage">Voc√™ ainda n√£o realizou nenhuma corrida.</p>
                <div id="driverHistoryList" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- PWA Install Button -->
    <button id="pwaInstallBtn" class="pwa-install-btn" title="Instalar App">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Test Notification Button (for debugging) -->
    <button id="testNotificationBtn" class="test-notification-btn" title="Testar Notifica√ß√£o">
        <i class="fas fa-bell"></i>
    </button>

    <!-- Audio element for notification sound -->
    <audio id="notificationSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
</body>
</html>